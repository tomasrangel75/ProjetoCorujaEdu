!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){n(1),t.exports=n(7)},function(t,e,n){"use strict";function o(t,e){return new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.className)}function i(t,e){t.classList?t.classList.add(e):o(t,e)||(t.className+=" "+e)}function r(){return C.interactive&&0!==parseInt(C.interactive,10)}function s(){return-1!==document.cookie.indexOf(k+"=1")}function c(){if(C.language&&window.l10n_str){var t=C.language.replace("_","-").toLowerCase(),e=w.getAttribute("data-translation");window.l10n_str[t]&&window.l10n_str[t][e]&&(w.innerText=window.l10n_str[t][e])}}function a(){if(!j)return!1;for(var t=[/^http[s]?:\/\/([\w\.-]+\.)?tumblr\.(com|net)(:[0-9]+)?(\/.*)?$/i],e=0,n=t.length;n>e;e++)if(t[e].test(j))return!0;return!1}function l(t,e){var n=[];for(var o in t){var i=e?e+"["+o+"]":o,r=t[o];n.push("object"===("undefined"==typeof r?"undefined":f(r))?l(r,i):encodeURIComponent(i)+"="+encodeURIComponent(r))}return n.join("&")}function h(){return window.location.hash.replace(/[#?&]+([^=&]+)(=[^&]*)?/gi,function(t,e,n){C[e]="undefined"==typeof n?!0:decodeURIComponent(n.substring(1))}),C}function d(){p=new _({window:window.parent,namespace:"tumblr-follow-iframe",origin:"*"})}function u(){var t=y.offsetWidth;p.send("sizeChange",t)}var p,f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},_=n(2),g=n(6),m=document.getElementById("tumblr-logo"),y=document.getElementById("follow-wrapper"),w=document.getElementById("follow"),v="//www.tumblr.com",b=v+"/register/follow/",j=document.referrer,k="logged_in",C={};if(h(),c(),d(),r()&&s()&&a())document.location.replace(v+"/embed/embed_follow_iframe?"+l(C));else{var x=new g(C.tumblelog_mention_key,C.post_id,C.ref_url);m.href=x.genClickthroughUrl(v,"logo"),w.href=x.genClickthroughUrl(b+C.name,"follow_button"),y.removeAttribute("style"),i(y,"show"),u()}},function(t,e,n){"use strict";function o(t){return"string"==typeof t||t&&"object"===("undefined"==typeof t?"undefined":a(t))&&"[object String]"===p.call(t)||!1}function i(){var t=new _;return t.cid=g,g+=1,m[t.cid]=t,t}function r(t,e){for(var n,o=y.length-1;o>=0;o--)y[o].message_callback(t,e);for(o=w.length-1;o>=0;o--)n=w[o],n&&n.shouldRespond&&n.shouldRespond(t,e)&&n.cb(t,e)}function s(t){if(t||(t={}),!(h&&h.stringify&&h.parse))throw"Must have JSON parsing and stringify";if(t.iframe&&(t.window=t.iframe.contentWindow,!t.origin)){var e=t.iframe.src,n=e.match(/^(http(?:s)?:\/\/[\w_\-\.]+(?::\d+)?)\/?/);n&&(t.origin=n[1])}this.namespace=t.namespace?t.namespace+":":"",this.origin=t.origin||"*",this.responders={_method_callback_responder:v,_syn:u(this._syn,this)},this._on_connected=new f,this._unanswered_calls={},this.on_connection(u(this.enable_sending_post_message,this)),y.push(this),t.window&&this.setWindow(t.window)}function c(t,e,n){n||(n=this.origin),t.postMessage(e,n)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},l=n(3),h=l("JSON",function(t){return t&&t.stringify}),d=[].slice,u=function(t,e){return function(){return t.apply(e,arguments)}},p=Object.prototype.toString,f=n(4),_=n(5),g=1,m={},y=[],w=[];!function(){var t=window.addEventListener?"addEventListener":"attachEvent",e=window[t],n="attachEvent"===t?"onmessage":"message";e(n,function(t){var e;if("string"==typeof t.data){try{t.data&&"{"===t.data[0]&&(e=h.parse(t.data))}catch(n){}e&&e.method&&r(t,e)}},!1)}();var v=function(t){if(t.cid_response&&t.cid_response in m){var e=m[t.cid_response];e.resolve.call(null,this,t.response),delete m[t.cid_response]}};s.prototype.setWindow=function(t){if(t){this.window=t;var e=this.call("_syn");e.then(u(function(t,e){"ack"===e&&this._is_connected()},this))}},s.on=function(t,e){var n;n="*"===t?function(){return!0}:"*"===t[t.length-1]?function(e,n){return 0===n.method.indexOf(t.substring(0,t.length-2))}:function(e,n){return n.method===t},w.push({shouldRespond:n,cb:e})},s.off=function(t){for(var e,n=w.length-1;n>=0;n--)if(w[n].cb===t){e=n;break}return e&&e>-1?(w.splice(e,1),!0):!1},s.prototype.match_origin=function(t){return"*"===this.origin?!0:this.origin===t},s.prototype.message_callback=function(t,e){var n;if((!this.window||t.source===this.window)&&this.match_origin(t.origin)){if(e.method&&e.method.slice(0,this.namespace.length)===this.namespace&&(n=e.method.slice(this.namespace.length,e.method.length)),e.args&&o(e.args))try{e.args=h.parse(e.args)}catch(i){return}this.call_responder(n,t,e)}},s.prototype.call_responder=function(t,e,n){var o,i;if(t){if(n.args||(n.args=[]),i=this.responders[t],!i)return this._unanswered_calls[t]||(this._unanswered_calls[t]=[]),void this._unanswered_calls[t].push(arguments);o=i.apply(e,n.args),n.cid&&"_method_callback_responder"!==t&&this.send_to_window(e.source,"_method_callback_responder",{cid_response:n.cid,response:o})}},s.prototype._syn=function(){return this._is_connected(),"ack"},s.prototype._is_connected=function(){this.connected||(this.connected=!0,this._on_connected.trigger(this))},s.prototype.on_connection=function(t){return this._on_connected.push.apply(this._on_connected,arguments),this},s.prototype.method=function b(t){var e=this,b=function(){var n=1<=arguments.length?d.call(arguments,0):[];return n.unshift(t),e.send.apply(e,n)};return b},s.prototype.call=function(){var t=1<=arguments.length?d.call(arguments,0):[];return this.window?(t.unshift(this.window),this.call_on_window.apply(this,t)):void console.warn("no window specified on channel")},s.prototype.call_on_window=function(t,e){var n=3<=arguments.length?d.call(arguments,2):[],o=i();try{var r=h.stringify({method:this.namespace+e,args:n,cid:o.cid});"_syn"===e||"_method_callback_responder"===e?c.call(this,t,r):this.send_post_message(t,r)}catch(s){o.reject(s)}return o.promise()},s.prototype.send=function(){var t=1<=arguments.length?d.call(arguments,0):[];return this.window?(t.unshift(this.window),this.send_to_window.apply(this,t)):void console.warn("no window specified on channel")},s.prototype.send_to_window=function(t,e){var n=3<=arguments.length?d.call(arguments,2):[],o=h.stringify({method:this.namespace+e,args:n});"_syn"===e||"_method_callback_responder"===e?c.call(this,t,o):this.send_post_message(t,o)},s.prototype.send_post_message=function(){this._delayed_sent_messages||(this._delayed_sent_messages=[]),this._delayed_sent_messages.push(arguments)},s.prototype.enable_sending_post_message=function(){if(this.send_post_message=c,this._delayed_sent_messages){for(var t=0;t<this._delayed_sent_messages.length;t+=1)c.apply(this,this._delayed_sent_messages[t]);delete this._delayed_sent_messages}},s.prototype.listening_to=function(t){return t in this.responders},s.prototype.listen_to=function(t,e,n){if(o(t)){if(t in this.responders)return void console.warn("already listening to this method, turn it off first");if(n&&(e=u(e,n)),this.responders[t]=e,this._unanswered_calls[t]){var i,r=this._unanswered_calls[t];delete this._unanswered_calls[t];for(var s=0;s<r.length;s+=1)i=r[s],this.call_responder.apply(this,i)}}else{var c=t;for(t in c)c.hasOwnProperty(t)&&this.listen_to(t,c[t],n)}},s.prototype.stop_listen_to=function(t){return"_method_callback_responder"===t?void console.warn("cannot disable the method callback responder"):void delete this.responders[t]},s.prototype.ensureChannelConnection=function(t){this.send_to_window(t,"_syn")},t.exports=s},function(t,e){"use strict";function n(t,e){if(t in o)return o[t];var n=window[t];if(!e||!e(n)){var i=document.createElement("iframe");document.body.appendChild(i),n=i.contentWindow[t],document.body.removeChild(i)}return o[t]=n,n}var o={};t.exports=n},function(t,e){"use strict";function n(){this.length=0}var o=[].slice,i=[].push;n.prototype={slice:o,indexOf:Array.prototype.indexOf},n.prototype.push=function(){if(this.triggered_with)for(var t=1<=arguments.length?o.call(arguments,0):[],e=0;e<t.length;e+=1)t[e].apply(null,this.triggered_with);return i.apply(this,arguments)},n.prototype.trigger=function(){var t=1<=arguments.length?o.call(arguments,0):[],e=this.length;this.triggered_with=t;for(var n=0;e>n;n+=1)this[n].apply(null,this.triggered_with);return this},t.exports=n},function(t,e,n){"use strict";function o(){this._on_resolved=new s,this._on_rejected=new s,this.then=r(this.then,this),this.fail=r(this.fail,this),this.resolve=r(this.resolve,this),this.reject=r(this.reject,this)}var i=[].slice,r=function(t,e){return function(){return t.apply(e,arguments)}},s=n(4);o.prototype.then=function(){return this._on_resolved.push.apply(this._on_resolved,arguments),this},o.prototype.success=o.prototype.then,o.prototype.fail=function(){return this._on_resolved.push.apply(this._on_rejected,arguments),this},o.prototype.resolve=function(){return this.resolved||this.rejected?void 0:(this._on_resolved.trigger.apply(this._on_resolved,arguments),this.resolved=!0,this)},o.prototype.reject=function(){return this.resolved||this.rejected?void 0:(this._on_rejected.trigger.apply(this._on_rejected,arguments),this.rejected=!0,this)},o.prototype.reject_timeout=function(){var t=1<=arguments.length?i.call(arguments,0):[],e=t.shift();return setTimeout(r(function(){this.reject.apply(this,t)},this),e),this},o.prototype.promise=function(){function t(){var t=this;this.fail=function(){return e.fail.apply(e,arguments),t},this.then=function(){return e.then.apply(e,arguments),t},this.success=this.then,this.reject_timeout=function(){return e.reject_timeout.apply(e,arguments),t},this.cid=e.cid}var e=this;return new t},t.exports=o},function(t,e,n){"use strict";function o(t,e,n){this.baseUrl="//www.tumblr.com",this.tumblelogMentionKey=t,this.postId=e,this.refUrl=n,this.trackClickthrough=function(t,e){var n=this.genClickthroughUrl(null,t),o=new Image;e&&(o.onerror=e,o.onload=e),o.src=n},this.genClickthroughUrl=function(t,e){var n=this.baseUrl+"/embed/clickthrough/"+this.tumblelogMentionKey+"/"+this.postId+"/"+e,o={};t&&(o.url=t);var i=this.refUrl||document.referrer;return i&&(o.refUrl=i),n+"?"+this._httpBuildQuery(o)},this._httpBuildQuery=function(t){var e,n,o=[];for(e in t)n=encodeURIComponent(decodeURIComponent(t[e].toString())),e=encodeURIComponent(decodeURIComponent(e)),o.push(e+"="+n);return o.join("&")}}t.exports=o},function(t,e){}]);